<!DOCTYPE html>
<html>
  <head>
    <title>My experiment</title>
    <!-- jsPsych library -->
    <script src="https://ovimo737.github.io/jsPsychSheet/jspsych/jspsych.js"></script>
    <script src="https://ovimo737.github.io/jsPsychSheet/jspsych/plugins/jspsych-html-keyboard-response.js"></script>
    <script src="https://ovimo737.github.io/jsPsychSheet/jspsych/plugins/jspsych-fullscreen.js"></script>
    <script src="https://ovimo737.github.io/jsPsychSheet/jspsych/plugins/jspsych-survey-text.js"></script>
    <script src="https://ovimo737.github.io/jsPsychSheet/jspsych/plugins/jspsych-html-button-response.js"></script>
    <script src="https://ovimo737.github.io/jsPsychSheet/jspsych/plugins/jspsych-image-keyboard-response.js"></script>
    <link rel="stylesheet" href="https://ovimo737.github.io/jsPsychSheet/jspsych/css/jspsych.css">
    <!-- jsPsychSheet library -->
    <base target="_top">
    <script src="https://ovimo737.github.io/jsPsychSheet/jspsychsheet.js"></script>
    <link rel="stylesheet" href="https://ovimo737.github.io/jsPsychSheet/jspsychsheet.css">

    <!-- <script src="jspsych-6.1.0/jspsych.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-fullscreen.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-survey-text.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-html-keyboard-response.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-html-button-response.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-image-keyboard-response.js"></script> -->
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script> -->
    <!-- <link href="jspsych-6.1.0/css/jspsych.css" rel="stylesheet" type="text/css"></link> -->
  </head>
  <body></body>
  <script>

    var timeline =[];

    timeline.push({
      type: 'fullscreen',
      fullscreen_mode: true
    });

    var welcome = {
      type: "html-keyboard-response",
      stimulus: "Welcome to the experiment. Press any key to begin."
    } ;
    timeline.push(welcome)

    var consentform = {
      type: 'html-button-response',
      stimulus: '<p>Please read the following and press the button at the bottom of the screen to begin.</p><p></p>'+
      '<p><h1><strong>PARTICIPANT INFORMATION STATEMENT</strong></h1></p><p></p>'+
      '<div align=left>'+
      '<p><strong>Project Title: </strong>Executive Functions and Reasoning</p>' +
      '<p><strong>Project Summary:</strong><br />You are invited to participate in an online study conducted by  under the supervision of Tijl Grootswagers and Manuel Varlet from the MARCS Institute for Brain, Behaviour and Development. This research investigates how the brain processes visual stimuli.</p>' +
      '<p><strong>How is the study being paid for?</strong><br />The research is supported by the MARCS institute for Brain, Behaviour & Development, Western Sydney University.</p>' +
      '<p><strong>What will I be asked to do?</strong><br />During this online experiment, sequences of objects will be presented on your computer screen and your task will be to respond via your keyboard to specific stimuli in the sequences and/or questions about the stimuli. The experiment will last about min and requires access to the Internet and a laptop or desktop computer with a keyboard (no smartphone or tablet).</p>' +
      '<p><strong>How much of my time will I need to give?</strong><br />The total experiment will take roughly minutes.</p>' +
      '<p><strong>What benefits will I, and/or the broader community, receive for participating?</strong><br />You will have the opportunity to learn more about how scientific research is conducted, and also about the specific topic under investigation: Visual perception. You will receive 1 credit per 10 minutes through SONA.</p>' +
      '<p><strong>Will the study involve any risk or discomfort for me? If so, what will be done to rectify it?</strong><br />There are no risks associated with this experiment.This study should not cause you any discomfort. However, should you experience any discomfort, you may discontinue participation at any time by closing your Internet browser.</p>' +
      '<p><strong>How do you intend to publish or disseminate the results?</strong><br />It is anticipated that the results of this research project will be published and/or presented in a variety of forums. In any publication and/or presentation, information will be provided in such a way that the participant cannot be identified.</p>' +
      "<p><strong>Will the data and information that I have provided be disposed of?</strong><br />No. Your data will be used as per Western Sydney University's Open Access Policy. This means that data collected from this study can be made available online and world-wide in perpetuity.</p>" +
      '<p><strong>Can I withdraw from the study?</strong><br />Participation is entirely voluntary and you are not obliged to be involved. If you do participate you can withdraw by closing your Internet browser at any time without giving reason. If you do choose to withdraw, any information that you have supplied will be withdrawn from the database.</p>' +
      "<p><strong>Can I tell other people about the study?</strong><br />Yes, you can tell other people about the study by providing them with the Chief Investigator's contact details. They can contact the Chief Investigator to discuss their participation in the research project and obtain a copy of the information sheet.</p>" +
      '<p><strong>What if I require further information?</strong><br />Please contact Oviya Mohan , Dr Tijl Grootswagers (T.Grootswagers@westernsydney.edu.au) or Dr Manuel Varlet (m.varlet@westernsydney.edu.au) if further information is required.</p>' +
      '<p><strong>What if I have a complaint?</strong><br />If you have any complaints Tel +61247360229 or email humanethics@westernsydney.edu.au<br />Any issues you raise will be treated in confidence and investigated fully, and you will be informed of the outcome.<br />If you agree to participate in this study, you may be asked to sign the Participant Consent Form.<br /></p>' +
      '</div><p></p>'+
      '<p><h1><strong>CONSENT FORM</strong></h1></p><p></p>' +
      '<div align=left>' +
      '<p>This study has been approved by the Human Research Ethics Committee at Western Sydney University. The ethics reference number is: H13092</p>' +
      '<p><strong>I hereby consent to participate in the above named research project.</strong></p>' +
      '<p><strong>I acknowledge that:</strong></p>' +
      '<p>- I have read the online participant information sheet.</p>' +
      '<p>- The procedures required for the project and the time involved have been clearly explained.</p>' +
      '<p><strong>I consent to:</strong></p>' +
      '<p>- The recording of my responses.</p>' +
      '<p><strong> Data publication, reuse and storage</strong></p>' +
      '<p>This project seeks consent for the data provided to be used in any other projects in the future.</p>' +
      "<p>To make reuse of the data possible it will be stored under Western Sydney University's Open Access Policy.</p>" +
      '<p>I understand that in relation to publication of the data <strong>my involvement is confidential and the information gained during the study may be published but no information about me will be used in any way that reveals my identity.</strong></p>' +
      '<p>- The researchers intend to make the non-identified data from this project available for other research projects.</p>' +
      '<p><strong>- I can withdraw from the study at any time without affecting my relationship with the researcher/s, and any organisations involved, now or in the future.</strong></p>' +
      '</div><p></p>',
      choices: ['I CONSENT TO PARTICIPATE IN THIS STUDY'],
      prompt: "<p><small>Click this button to continue, or press ESC to exit.</small></p><p></p>",
      data: {stimulus: 'consentform'}
    };
    timeline.push(consentform)

    var get_name = {
      type: 'survey-text',
      questions: [
        {prompt: 'Please enter your name', columns: 15, required: true, name: 'Name'},
        {prompt: 'Please enter your roll number', columns: 10, required: true, name: 'Rollno'},
        {prompt: 'Please enter your age', columns: 4, required: true, name: 'Age'}

      ]
    };
    timeline.push(get_name)

    var instructions = {
      type: "html-keyboard-response",
      stimulus: "<p>In this experiment, you will see one of two shapes: an orange circle or a blue circle.</p> " +
        "<p>The circle will appear at different locations, but the location is not important.</p>"+
        "<p>If the circle is <strong>orange</strong>, press the letter <strong>Z</strong> on the keyboard as fast as you can.</p>" +
        "<p>If the circle is <strong>blue</strong>, press the letter <strong>M</strong> on the keyboard as fast as you can.</p>" +
        "<div style='width: 400px; margin: 0 auto;'>"+
        "<div style='float: left;'><img src='https://ovimo737.github.io/jsPsychSheet/experiment/img/orange.png', width ='150px', height = '150px'></img>" +
        "<p class='small'><strong>Press the Z key</strong></p></div>" +
        "<div class='float: right;'><img src='https://ovimo737.github.io/jsPsychSheet/experiment/img/blue.png', width ='150px', height = '150px'></img>" +
        "<p class='small'><strong>Press the M key</strong></p></div>" +
        "</div>"+
        "<p>Press any key to begin.</p>"
    };
    timeline.push(instructions)

    // var blue_trial = {
    //   type: 'image-keyboard-response',
    //   stimulus: 'img/blue.png',
    //   choices: ['f', 'j']
    // };
    //
    // var orange_trial = {
    //   type: 'image-keyboard-response',
    //   stimulus: 'img/orange.png',
    //   choices: ['f', 'j']
    // };
    // timeline.push(blue_trial, orange_trial)

    var test_stimuli = [
      { stimulus: "<div style ='width:350px; text-align:right;'>"+"<img src='https://ovimo737.github.io/jsPsychSheet/experiment/img/blue.png' width = '150px', height = '150px'>"+"</div>", data: {test_part: 'test', color:'blue', pos:"1", condition:'cong', correct_response: 'm'}},
      { stimulus: "<div style ='width:700px; text-align:right;'>"+"<img src='https://ovimo737.github.io/jsPsychSheet/experiment/img/blue.png' width = '150px', height = '150px'>"+"</div>", data: {test_part: 'test', color:'blue', pos:"2", condition:'cong', correct_response: 'm'}},
      { stimulus: "<div style ='width:1400px; text-align:right;'>"+"<img src='https://ovimo737.github.io/jsPsychSheet/experiment/img/blue.png' width = '150px', height = '150px'>"+"</div>", data: {test_part: 'test', color:'blue', pos:"3", condition:'cong', correct_response: 'm'}},
      { stimulus: "<div style ='width:350px; text-align:left;'>"+"<img src='https://ovimo737.github.io/jsPsychSheet/experiment/img/blue.png' width = '150px', height = '150px'>"+"</div>", data: {test_part: 'test', color:'blue', pos:"-1", condition:'incong', correct_response: 'm'}},
      { stimulus: "<div style ='width:700px; text-align:left;'>"+"<img src='https://ovimo737.github.io/jsPsychSheet/experiment/img/blue.png' width = '150px', height = '150px'>"+"</div>", data: {test_part: 'test', color:'blue', pos:"-2", condition:'incong', correct_response: 'm'}},
      { stimulus: "<div style ='width:1400px; text-align:left;'>"+"<img src='https://ovimo737.github.io/jsPsychSheet/experiment/img/blue.png' width = '150px', height = '150px'>"+"</div>", data: {test_part: 'test', color:'blue', pos:"-3", condition:'incong', correct_response: 'm'}},
      { stimulus: "<div style ='width:350px; text-align:right;'>"+"<img src='https://ovimo737.github.io/jsPsychSheet/experiment/img/orange.png' width = '150px', height = '150px'>"+"</div>", data: {test_part: 'test', color:'orange', pos:"1", condition:'incong', correct_response: 'z'}},
      { stimulus: "<div style ='width:700px; text-align:right;'>"+"<img src='https://ovimo737.github.io/jsPsychSheet/experiment/img/orange.png' width = '150px', height = '150px'>"+"</div>", data: {test_part: 'test', color:'orange', pos:"2", condition:'incong', correct_response: 'z'}},
      { stimulus: "<div style ='width:1400px; text-align:right;'>"+"<img src='https://ovimo737.github.io/jsPsychSheet/experiment/img/orange.png' width = '150px', height = '150px'>"+"</div>", data: {test_part: 'test', color:'orange', pos:"3", condition:'incong', correct_response: 'z'}},
      { stimulus: "<div style ='width:350px; text-align:left;'>"+"<img src='https://ovimo737.github.io/jsPsychSheet/experiment/img/orange.png' width = '150px', height = '150px'>"+"</div>", data: {test_part: 'test', color:'orange', pos:"-1", condition:'cong', correct_response: 'z'}},
      { stimulus: "<div style ='width:700px; text-align:left;'>"+"<img src='https://ovimo737.github.io/jsPsychSheet/experiment/img/orange.png' width = '150px', height = '150px'>"+"</div>", data: {test_part: 'test', color:'orange', pos:"-2", condition:'cong', correct_response: 'z'}},
      { stimulus: "<div style ='width:1400px; text-align:left;'>"+"<img src='https://ovimo737.github.io/jsPsychSheet/experiment/img/orange.png' width = '150px', height = '150px'>"+"</div>", data: {test_part: 'test', color:'orange', pos:"-3", condition:'cong', correct_response: 'z'}},
    ];

    var fixation = {
      type: 'html-keyboard-response',
      stimulus: '<div style="font-size:60px;">+</div>',
      choices: jsPsych.NO_KEYS,
      prompt: "<p style ='position:absolute; bottom:0px; right:25%; left:50%; margin-left:-400px; font-size:25px'>Press Z for ORANGE and Press M for BLUE</p>",
      trial_duration: 250,
      data: {test_part: 'fixation'}
    };

    var test = {
      type: "html-keyboard-response",
      stimulus: jsPsych.timelineVariable('stimulus'),
      choices: ['z', 'm'],
      prompt: "<p style ='position:absolute; bottom:0px; right:25%; left:50%; margin-left:-400px; font-size:25px'>Press Z for ORANGE and Press M for BLUE</p>",
      data: jsPsych.timelineVariable('data'),
      on_finish: function(data){
        data.correct = data.key_press == jsPsych.pluginAPI.convertKeyCharacterToKeyCode(data.correct_response);
      }
    };

    var test_procedure = {
      timeline: [fixation, test],
      timeline_variables: test_stimuli,
      randomize_order : true,
      repetitions: 1
    };
    timeline.push(test_procedure)

    var debrief_block = {
      type: "html-keyboard-response",
      stimulus: function() {

        var trials = jsPsych.data.get().filter({test_part: 'test'});
        var incong_all = jsPsych.data.get().filter({condition: 'incong'});
        var cong_all = jsPsych.data.get().filter({condition: 'cong'});

        var correct_trials = trials.filter({correct: true});
        var correct_incong = incong_all.filter({correct: true});
        var correct_cong = cong_all.filter({correct: true});

        var accuracy = Math.round(correct_trials.count() / trials.count() * 100);
        var accuracy_incong = Math.round(correct_incong.count() / incong_all.count() * 100);
        var accuracy_cong = Math.round(correct_cong.count() / incong_all.count() * 100);

        var rt = Math.round(correct_trials.select('rt').mean());
        var rt_incong = Math.round(correct_incong.select('rt').mean());
        var rt_cong = Math.round(correct_cong.select('rt').mean());

        return "<p>You responded correctly on "+accuracy+"% of the trials.</p>"+
        "<p>Your average response time was "+rt+"ms.</p>"+
        "<p>You responded correctly on "+accuracy_incong+"% of the INCONGRUENT trials.</p>"+
        "<p>Your average response time for INCONGRUENT trials was "+rt_incong+"ms.</p>"+
        "<p>You responded correctly on "+accuracy_cong+"% of the CONGRUENT trials.</p>"+
        "<p>Your average response time for CONGRUENT trials was "+rt_cong+"ms.</p>"+
        "<p>Press any key to complete the experiment. Thank you!</p>";

      }
    };
    timeline.push(debrief_block);

    timeline.push({
      type: 'fullscreen',
      fullscreen_mode: false
    });

    // function saveData(name, data){
    //   var xhr = new XMLHttpRequest();
    //   xhr.open('post_data', 'C:\\xampp\\htdocs\\write_data.php');
    //   // 'write_data.php' is the path to the php file described above.
    //   xhr.setRequestHeader('Content-Type', 'application/json');
    //   xhr.send(JSON.stringify({filename: name, filedata: data}));
    // }

    var images = ['https://ovimo737.github.io/jsPsychSheet/experiment/img/blue.png' ,'https://ovimo737.github.io/jsPsychSheet/experiment/img/orange.png'];


    jsPsych.init({
      timeline: timeline,
      preload_images : images,
      show_preload_progress_bar: false,
      // show_progress_bar: true,
      on_finish: function() {
            jsPsychSheet.uploadData(jsPsych.data.get().csv());
        // var interaction_data = jsPsych.data.getInteractionData();
        // // log data to console in json format
        // console.log(interaction_data.json());
        // saveData("experiment_data", jsPsych.data.get().csv());
        // jsPsych.data.displayData();
        // jsPsych.data.get().localSave('csv','Mydata.csv');
      }
    });



// // call the saveData function after the experiment is over
//     jsPsych.init({
//    // code to define the experiment structure would go here...
//       on_finish: function(){
//         saveData("experiment_data", jsPsych.data.get().json());
//       }
//     });
  </script>

</html>
